(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{393:function(t,a,s){"use strict";s.r(a);var e=s(46),l=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"js内存管理机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#js内存管理机制"}},[t._v("#")]),t._v(" js内存管理机制")]),t._v(" "),s("h2",{attrs:{id:"js内存生命周期"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#js内存生命周期"}},[t._v("#")]),t._v(" js内存生命周期")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("名称")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("分配内存")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("给当前要使用的数据分配内存空间")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("内存的读与写")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("内存空间中放入要存储的数据，可以对其数据读取和更改")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("内存释放")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("数据用完的把内存释放了")])])])]),t._v(" "),s("h2",{attrs:{id:"栈内存和堆内存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#栈内存和堆内存"}},[t._v("#")]),t._v(" 栈内存和堆内存")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("内存")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("数据类别")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("数据类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("栈内存")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("基本数据类型")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("String，Number，Boolean，null，undefined，Symbol")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("特征大小固定，体积轻量，相对简单")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("堆内存")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("引用数据类型")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Object，Array，Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("特征占用空间大，且大小不固定")])])])]),t._v(" "),s("h2",{attrs:{id:"垃圾回收机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#垃圾回收机制"}},[t._v("#")]),t._v(" 垃圾回收机制")]),t._v(" "),s("h3",{attrs:{id:"_1-引用计数法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-引用计数法"}},[t._v("#")]),t._v(" 1.引用计数法")]),t._v(" "),s("p",[t._v("如下例子：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" me "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'z'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'k'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("ol",[s("li",[t._v("当用一个变量指向一个值，那就创建了一个针对这个值的 “引用”")]),t._v(" "),s("li",[t._v("赋值表达式从右往左读")]),t._v(" "),s("li",[t._v("首先是开辟了一块内存，把右边的数组塞进去，此时这数组占据了一块内存")]),t._v(" "),s("li",[t._v("随后"),s("code",[t._v("me")]),t._v("变量指向它，这就是创建了一个该值的“引用”")]),t._v(" "),s("li",[t._v("此时数组的引用计数就是 1")]),t._v(" "),s("li",[t._v("在引用计数法的机制下，内存中每个值都会对应一个引用计数")]),t._v(" "),s("li",[t._v("当垃圾收集器感知到某个值为0，就会把这块内存释放")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" me "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 引用计数为0，释放内存")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"_2-标记清除法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-标记清除法"}},[t._v("#")]),t._v(" 2.标记清除法")]),t._v(" "),s("p",[t._v("2012年起，所有浏览器使用了标记清除算法")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[s("div",{staticStyle:{width:"80px"}},[t._v("阶段")])]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("标记阶段")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("垃圾收集器会先找到根对象，在浏览器里是"),s("code",[t._v("window")]),t._v(",node里是"),s("code",[t._v("Global")]),t._v(",垃圾收集器会扫描所有可以通过根对象触及的变量，这些对象会被标记为‘可抵达’")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("清楚阶段")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("没有被标记‘可抵达’的变量，会被认为是不需要的变量，这些变量会被清除")])])])]),t._v(" "),s("h2",{attrs:{id:"内存泄漏"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#内存泄漏"}},[t._v("#")]),t._v(" 内存泄漏")]),t._v(" "),s("p",[t._v("该释放的变量（内存垃圾）没有被释放，仍然霸占着原有的内存不松手，导致内存占用不断攀高，带来性能恶化、系统崩溃一些连问题")]),t._v(" "),s("h3",{attrs:{id:"内存泄漏的成因"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#内存泄漏的成因"}},[t._v("#")]),t._v(" 内存泄漏的成因")]),t._v(" "),s("ol",[s("li",[t._v("“手滑”导致全局变量")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("me")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'szk'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("会挂载到全局对象上")]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("忘记清楚的 setInterval 和 setTimeout")])]),t._v(" "),s("p",[t._v("不用的时候需要自行clear函数")])])}),[],!1,null,null,null);a.default=l.exports}}]);